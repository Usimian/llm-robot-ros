planning_plugins:
  - ompl_interface/OMPLPlanner

request_adapters:
  - default_planning_request_adapters/ResolveConstraintFrames
  - default_planning_request_adapters/ValidateWorkspaceBounds
  - default_planning_request_adapters/CheckStartStateBounds
  - default_planning_request_adapters/CheckStartStateCollision

response_adapters:
  - default_planning_response_adapters/AddTimeOptimalParameterization
  - default_planning_response_adapters/ValidateSolution
  - default_planning_response_adapters/DisplayMotionPath

# Planner Configurations - these define the actual planner algorithms with their parameters
planner_configs:
  # Parallel multi-planner - runs multiple planners simultaneously
  AnytimePathShortening:
    type: geometric::AnytimePathShortening
    shortcut: 1  # Attempt to shortcut all new solution paths
    hybridize: 1  # Compute hybrid solution trajectories
    max_hybrid_paths: 16  # Number of hybrid paths generated per iteration
    num_planners: 2  # Number of planners to run in parallel (reduced to avoid crashes)
    planners: "RRTConnect,LBKPIECE"  # Fast + robust combination

  # Fast planners - good for quick solutions
  RRTConnect:
    type: geometric::RRTConnect
    range: 0.0  # Auto-computed

  RRT:
    type: geometric::RRT
    range: 0.0
    goal_bias: 0.1  # Higher bias = faster convergence to goal

  EST:
    type: geometric::EST
    range: 0.0
    goal_bias: 0.1

  # Optimizing planners - find better quality paths
  RRTstar:
    type: geometric::RRTstar
    range: 0.0
    goal_bias: 0.1  # Increased from 0.05 for faster convergence
    delay_collision_checking: 1

  # Planners good for difficult/narrow passages
  KPIECE:
    type: geometric::KPIECE
    range: 0.0
    goal_bias: 0.1
    border_fraction: 0.9
    failed_expansion_score_factor: 0.5
    min_valid_path_fraction: 0.2  # More aggressive - accept partially valid paths

  LBKPIECE:
    type: geometric::LBKPIECE
    range: 0.0
    border_fraction: 0.9
    min_valid_path_fraction: 0.2

  # Bi-directional planners - often more robust
  BiTRRT:
    type: geometric::BiTRRT
    range: 0.0
    temp_change_factor: 0.1
    init_temperature: 100
    frountier_threshold: 0.0
    frountier_node_ratio: 0.1
    cost_threshold: 1e300

  LBTRRT:
    type: geometric::LBTRRT
    range: 0.0
    goal_bias: 0.1
    epsilon: 0.4

  BiEST:
    type: geometric::BiEST
    range: 0.0

  # Roadmap-based planners - good for complex environments
  PRM:
    type: geometric::PRM
    max_nearest_neighbors: 15  # Increased for better connectivity

  PRMstar:
    type: geometric::PRMstar

  LazyPRM:
    type: geometric::LazyPRM
    range: 0.0

  LazyPRMstar:
    type: geometric::LazyPRMstar

  # Advanced planners
  FMT:
    type: geometric::FMT
    num_samples: 2000  # Increased samples for better coverage
    radius_multiplier: 1.1
    nearest_k: 1
    cache_cc: 1
    heuristics: 1  # Enable heuristics
    extended_fmt: 1

# Group-specific configurations
arm:
  default_planner_config: AnytimePathShortening  # Very robust for difficult problems
  planner_configs:
    - AnytimePathShortening
    - LBKPIECE
    - KPIECE
    - RRTConnect
    - BiTRRT
    - LBTRRT
    - EST
    - RRT
    - RRTstar
    - LazyPRMstar
    - FMT
  projection_evaluator: joints(arm_shoulder_pan_joint,arm_shoulder_lift_joint,arm_elbow_joint)
  longest_valid_segment_fraction: 0.005

gripper:
  default_planner_config: RRTConnect
  planner_configs:
    - RRTConnect
    - RRTstar
  projection_evaluator: joints(finger_joint)
  longest_valid_segment_fraction: 0.01
